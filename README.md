# Предсказание конечной температуры сплава
***Описание проекта:*** 

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Нужно построить модель, которая предскажет конечную температуру стали.

***План работы над проектом:***

1. Знакомство с данными;
2. Предобработка данных;
3. Обучение моделей;
4. Общий вывод.

## Вывод
Нам нужно было построить модель, которая предскажет конечную температуру стали. Тем самым оптимизировав работу  металлургического комбината. Мы использовали данные с разных источников. Вот что мы сделали в этапе для подготовки к обучению моделей:
- удалили аномалии в столбце `Реактивная мощность`. Все значения, что `меньше -100`. Тут же агрегировали данные по партии, ссумировав показатели;
- заполнили все пропуски  в таблицах `data_bulk и data_wire` значением `0 - не добавляли материалы в итерации`;
- удалили из таблицы `data_temp` все партию, если была замечена температура `меньше 1500` в каком-то из этапов цикла;
- так же удалили партии, где был только один замер температуры за весь цикл
- создали новые признаки:
    - в `data_bulk, data_wire` = сумма значений добавляемых материалов;
    - в `data_temp` = начальная и конечная температура;
    - в `data_arc` = время нагрева, реактивная и активная мощность (сумма и среднее);
- затем соединили данные в один датафрейм по общему ключу;
- переименовали столбцы в получившейся таблице; 				
- далее разделили выборки на обучающую и тестовую;
- тестова выборка у нас `25%` от общей массы.

Для обучения мы выбрали `2 модели`. Одна классическая `DecisionTreeRegressor`, а вторая модель `CatBoostRegressor` (с бустингом). Оптимальные параметры подбирали при помощи `GridSearchCV`. Под нашу задачу в итоге подошла модель `CatBoostRegressor с параметрами 'depth': 4`. На тестовой выборке результат `MAE 6.2`

Признаки, которые больше всего влияют на предсказания модели:
1. `min_temp` - начальная температура
2. `sum_diff_seconds` - суммарное время нагрева ёмкости с металлом (сек.)
3. `wire_1` - количество загружаемой проволки в ёмкость в перовй итерации цикла
4. `mean_diff_seconds` - среднее значение времени нагрева ёмкости с металлом (сек.)
